<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>openxlsx2 basic manual</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">openxlsx2 basic manual</h1>



<p>Welcome to the basic manual to <code>openxlsx2</code>. In this manual
you will learn how to use <code>openxlsx2</code> to import data from
xlsx-files to R as well as how to export data from R to xlsx, and how to
import and modify these openxml workbooks in R. This package is based on
the work of many contributors to <code>openxlsx</code>. It was mostly
rewritten using <code>pugixml</code> and <code>R6</code> making use of
modern technology, providing a fresh and easy to use R package.</p>
<p>Over the years many people have worked on the tricky task to handle
xls and xlsx files. Notably <code>openxlsx</code>, but there are
countless other R-packages as well as third party libraries or
calculation software capable of handling such files. Please feel free to
use and test your files with other software and or let us know about
your experience. Open an issue on github or write us a mail.</p>
<div id="importing-data" class="section level2">
<h2>Importing data</h2>
<p>Coming from <code>openxlsx</code> you might know about
<code>read.xlsx()</code> (two functions, one for files and one for
workbooks) and <code>readWorkbook()</code>. Functions that do different
things, but mostly the same. In <code>openxlsx2</code> we tried our best
to reduce the complexity under the hood and for the user as well. In
<code>openxlsx2</code> they are replaced with <code>read_xlsx()</code>,
<code>wb_read()</code> and they share the same underlying function
<code>wb_to_df()</code>.</p>
<p>For this example we will use example data provided by the package.
You can locate it in our “inst/extdata” folder. The files are included
with the package source and you can open them in any calculation
software as well.</p>
<div id="basic-import" class="section level3">
<h3>Basic import</h3>
<p>We begin with the <code>openxlsx2_example.xlsx</code> file by telling
R where to find this file on our system</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;openxlsx2_example.xlsx&quot;</span>, <span class="at">package =</span> <span class="st">&quot;openxlsx2&quot;</span>)</span></code></pre></div>
<p>The object contains a path to the xlsx file and we pass this file to
our function to read the workbook into R</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># import workbook</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(openxlsx2)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">wb_to_df</span>(file)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;     Var1 Var2 NA  Var3  Var4       Var5         Var6    Var7     Var8</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; 3   TRUE    1 NA     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 4   TRUE   NA NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span></span></code></pre></div>
<p>The output is created as a data frame and contains data types date,
logical, numeric and character. The function to import the file to R,
<code>wb_to_df()</code> provides similar options as the
<code>openxlsx</code> functions <code>read.xlsx()</code> and
<code>readWorkbook()</code> and a few new functions we will go through
the options. As you might have noticed, we return the column of the xlsx
file as the row name of the data frame returned. Per default the first
sheet in the workbook is imported. If you want to switch this, either
provide the <code>sheet</code> parameter with the correct index or
provide the sheet name.</p>
</div>
<div id="col_names---first-row-as-column-name" class="section level3">
<h3><code>col_names</code> - first row as column name</h3>
<p>In the previous example the first imported row was used as column
name for the data frame. This is the default behavior, but not always
wanted or expected. Therefore this behavior can be disabled by the
user.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># do not convert first row to column names</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;        B    C  D     E     F          G            H       I        J</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 2     NA Var2 NA  Var3  Var4       Var5         Var6    Var7     Var8</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 3   TRUE    1 NA     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 4   TRUE &lt;NA&gt; NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; 9     NA &lt;NA&gt; NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="detect_dates---convert-cells-to-r-dates" class="section level3">
<h3><code>detect_dates</code> - convert cells to R dates</h3>
<p>The creators of the openxml standard are well known for mistakenly
treating something as a date and <code>openxlsx2</code> has built in
ways to identify a cell as a date and will try to convert the value for
you, but unfortunately this is not always a trivial task and might fail.
In such a case we provide an option to disable the date conversion
entirely. In this case the underlying numerical value will be
returned.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># do not try to identify dates in the data</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">detect_dates =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;     Var1 Var2 NA  Var3  Var4  Var5         Var6    Var7       Var8</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 3   TRUE    1 NA     1     a 45075 3209324 This #DIV/0! 0.06059028</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 4   TRUE   NA NA #NUM!     b 45069         &lt;NA&gt;       0 0.58538194</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 5   TRUE    2 NA  1.34     c 44958         &lt;NA&gt; #VALUE! 0.95905093</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2 NA  &lt;NA&gt; #NUM!    NA         &lt;NA&gt;       2 0.72561343</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3 NA  1.56     e    NA         &lt;NA&gt;    &lt;NA&gt;         NA</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1 NA   1.7     f 44987         &lt;NA&gt;     2.7 0.36525463</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;    NA         &lt;NA&gt;    &lt;NA&gt;         NA</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2 NA    23     h 45284         &lt;NA&gt;      25         NA</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3 NA  67.3     i 45285         &lt;NA&gt;       3         NA</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 12    NA    1 NA   123  &lt;NA&gt; 45138         &lt;NA&gt;     122         NA</span></span></code></pre></div>
</div>
<div id="show_formula---show-formulas-instead-of-results" class="section level3">
<h3><code>show_formula</code> - show formulas instead of results</h3>
<p>Sometimes things might feel off. This can be because the openxml
files are not updating formula results in the sheets unless they are
opened in software that provides such functionality as certain tabular
calculation software. Therefore the user might be interested in the
underlying functions to see what is going on in the sheet. Using
<code>show_formula</code> this is possible</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># return the underlying Excel formula instead of their values</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">show_formula =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;     Var1 Var2 NA  Var3  Var4       Var5         Var6            Var7     Var8</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 3   TRUE    1 NA     1     a 2023-05-29 3209324 This            E3/0 01:27:15</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 4   TRUE   NA NA #NUM!     b 2023-05-23         &lt;NA&gt;              C4 14:02:57</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt;         #VALUE! 23:01:02</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;           C6+E6 17:24:53</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;            &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;           C8+E8 08:45:58</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;            &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;    SUM(C10,E10)     &lt;NA&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt; PRODUCT(C11,E3)     &lt;NA&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;         E12-C12     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="dims---read-specific-dimension" class="section level3">
<h3><code>dims</code> - read specific dimension</h3>
<p>Sometimes the entire worksheet contains to much data, in such case we
provide functions to read only a selected dimension range. Such a range
consists of either a specific cell like “A1” or a cell range in the
notion used in the <code>openxml</code> standard</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># read dimension without column names</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">dims =</span> <span class="st">&quot;A2:C5&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;    A    B    C</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; 2 NA   NA Var2</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; 3 NA TRUE    1</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; 4 NA TRUE &lt;NA&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; 5 NA TRUE    2</span></span></code></pre></div>
<p>Alternatively, if you don’t know the Excel sheet’s address, you can
use <code>wb_dims()</code> to specify the dimension. See below or
in<code>?wb_dims</code> for more details.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># read dimension without column names with `wb_dims()`</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">dims =</span> <span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt;    A    B    C</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 2 NA   NA Var2</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 3 NA TRUE    1</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 4 NA TRUE &lt;NA&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 5 NA TRUE    2</span></span></code></pre></div>
</div>
<div id="cols---read-selected-columns" class="section level3">
<h3><code>cols</code> - read selected columns</h3>
<p>If you do not want to read a specific cell, but a cell range you can
use the column attribute. This attribute takes a numeric vector as
argument</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># read selected cols</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;A:B&quot;</span>, <span class="st">&quot;G&quot;</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;    NA  Var1       Var5</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; 3  NA  TRUE 2023-05-29</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; 4  NA  TRUE 2023-05-23</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; 5  NA  TRUE 2023-02-01</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 6  NA FALSE       &lt;NA&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 7  NA FALSE       &lt;NA&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 8  NA FALSE 2023-03-02</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 9  NA    NA       &lt;NA&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 10 NA FALSE 2023-12-24</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 11 NA FALSE 2023-12-25</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; 12 NA    NA 2023-07-31</span></span></code></pre></div>
</div>
<div id="rows---read-selected-rows" class="section level3">
<h3><code>rows</code> - read selected rows</h3>
<p>The same goes with rows. You can select them using numeric
vectors</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># read selected rows</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;    Var1 Var2 NA  Var3  Var4       Var5 Var6 Var7     Var8</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; 4  TRUE   NA NA #NUM!     b 2023-05-23   NA    0 14:02:57</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 6 FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;   NA    2 17:24:53</span></span></code></pre></div>
</div>
<div id="convert---convert-input-to-guessed-type" class="section level3">
<h3><code>convert</code> - convert input to guessed type</h3>
<p>In xml exists no difference between value types. All values are per
default characters. To provide these as numerics, logicals or dates,
<code>openxlsx2</code> and every other software dealing with xlsx files
has to make assumptions about the cell type. This is especially tricky
due to the notion of worksheets. Unlike in a data frame, a worksheet can
have a wild mix of all types of data. Even though the conversion process
from character to date or numeric is rather solid, sometimes the user
might want to see the data without any conversion applied. This might be
useful in cases where something unexpected happened or the import
created warnings. In such a case you can look at the raw input data. If
you want to disable date detection as well, please see the entry
above.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># convert characters to numerics and date (logical too?)</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">convert =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;     Var1 Var2   NA  Var3  Var4       Var5         Var6    Var7     Var8</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; 3   TRUE    1 &lt;NA&gt;     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; 4   TRUE &lt;NA&gt; &lt;NA&gt; #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; 5   TRUE    2 &lt;NA&gt;  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2 &lt;NA&gt;  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3 &lt;NA&gt;  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1 &lt;NA&gt;   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; 9   &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2 &lt;NA&gt;    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3 &lt;NA&gt;  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; 12  &lt;NA&gt;    1 &lt;NA&gt;   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="skip_empty_rows---remove-empty-rows" class="section level3">
<h3><code>skip_empty_rows</code> - remove empty rows</h3>
<p>Even though <code>openxlsx2</code> imports everything as requested,
sometimes it might be helpful to remove empty lines from the data. These
might be either left empty intentional or empty because they are were
formatted, but the cell value was removed afterwards. This was added
mostly for backward comparability, but the default has been changed to
<code>FALSE</code>. The behavior has changed a bit as well. Previously
empty cells were removed prior to the conversion to R data frames, now
they are removed after the conversion and are removed only if they are
completely empty</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># erase empty rows from dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">skip_empty_rows =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt;     Var1 Var2 NA Var3  Var4       Var5 Var6 Var7     Var8</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2 NA &lt;NA&gt; #NUM!       &lt;NA&gt; &lt;NA&gt;    2 17:24:53</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3 NA 1.56     e       &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1 NA  1.7     f 2023-03-02 &lt;NA&gt;  2.7 08:45:58</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2 NA   23     h 2023-12-24 &lt;NA&gt;   25     &lt;NA&gt;</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3 NA 67.3     i 2023-12-25 &lt;NA&gt;    3     &lt;NA&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 12    NA    1 NA  123  &lt;NA&gt; 2023-07-31 &lt;NA&gt;  122     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="skip_empty_cols---remove-empty-columns" class="section level3">
<h3><code>skip_empty_cols</code> - remove empty columns</h3>
<p>The same for columns</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># erase empty cols from dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">skip_empty_cols =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt;     Var1 Var2  Var3  Var4       Var5         Var6    Var7     Var8</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; 3   TRUE    1     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; 4   TRUE   NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; 5   TRUE    2  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; 9     NA   NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; 12    NA    1   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="row_names---keep-rownames-from-input" class="section level3">
<h3><code>row_names</code> - keep rownames from input</h3>
<p>Sometimes the data source might provide rownames as well. In such a
case you can <code>openxlsx2</code> to treat the first column as
rowname</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># convert first row to rownames</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">sheet =</span> <span class="dv">2</span>, <span class="at">dims =</span> <span class="st">&quot;C6:G9&quot;</span>, <span class="at">row_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt;                mpg cyl disp  hp</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; Mazda RX4     21.0   6  160 110</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; Mazda RX4 Wag 21.0   6  160 110</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; Datsun 710    22.8   4  108  93</span></span></code></pre></div>
</div>
<div id="types---convert-column-to-specific-type" class="section level3">
<h3><code>types</code> - convert column to specific type</h3>
<p>If the user know better than the software what type to expect in a
worksheet, this can be provided via types. This parameter takes a named
numeric. <code>0</code> is character, <code>1</code> is numeric and
<code>2</code> is date</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># define type of the data.frame</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>), <span class="at">types =</span> <span class="fu">c</span>(<span class="st">&quot;Var1&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;Var3&quot;</span> <span class="ot">=</span> <span class="dv">1</span>))</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;     Var1   Var3</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; 3   TRUE   1.00</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; 4   TRUE    NaN</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; 5   TRUE   1.34</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; 6  FALSE     NA</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; 7  FALSE   1.56</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; 8  FALSE   1.70</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; 9   &lt;NA&gt;     NA</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; 10 FALSE  23.00</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; 11 FALSE  67.30</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; 12  &lt;NA&gt; 123.00</span></span></code></pre></div>
</div>
<div id="start_row---where-to-begin" class="section level3">
<h3><code>start_row</code> - where to begin</h3>
<p>Often the creator of the worksheet has used a lot of creativity and
the data does not begin in the first row, instead it begins somewhere
else. To define the row where to begin reading, define it via the
<code>start_row</code> parameter</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># start in row 5</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">start_row =</span> <span class="dv">5</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt;        B  C  D      E     F          G  H       I        J</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; 5   TRUE  2 NA   1.34     c 2023-02-01 NA #VALUE! 23:01:02</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; 6  FALSE  2 NA     NA #NUM!       &lt;NA&gt; NA       2 17:24:53</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; 7  FALSE  3 NA   1.56     e       &lt;NA&gt; NA    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; 8  FALSE  1 NA   1.70     f 2023-03-02 NA     2.7 08:45:58</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; 9     NA NA NA     NA  &lt;NA&gt;       &lt;NA&gt; NA    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; 10 FALSE  2 NA  23.00     h 2023-12-24 NA      25     &lt;NA&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; 11 FALSE  3 NA  67.30     i 2023-12-25 NA       3     &lt;NA&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; 12    NA  1 NA 123.00  &lt;NA&gt; 2023-07-31 NA     122     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="na.strings---define-missing-values" class="section level3">
<h3><code>na.strings</code> - define missing values</h3>
<p>There is the “#N/A” string, but often the user will be faced with
custom missing values and other values we are not interested. Such
strings can be passed as character vector via
<code>na.strings</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># na strings</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">wb_to_df</span>(file, <span class="at">na.strings =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;     Var1 Var2 NA  Var3  Var4       Var5         Var6    Var7     Var8</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; 3   TRUE    1 NA     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; 4   TRUE   NA NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="importing-as-workbook" class="section level3">
<h3>Importing as workbook</h3>
<p>In addition to importing directly from xlsx or xlsm files,
<code>openxlsx2</code> provides the <code>wbWorkbook</code> class used
for importing and modifying entire the openxml files in <code>R</code>.
This <code>workbook</code> class is the heart of <code>openxlsx2</code>
and probably the reason why you are reading this manual in the first
place.</p>
<p>Importing a file into a workbook looks like this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># the file we are going to load</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;openxlsx2_example.xlsx&quot;</span>, <span class="at">package =</span> <span class="st">&quot;openxlsx2&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># loading the file into the workbook</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_load</span>(<span class="at">file =</span> file)</span></code></pre></div>
<p>The additional options <code>wb_load()</code> provides are for
internal use: <code>sheet</code> loads only a selected sheet from the
workbook and <code>data_only</code> reads only the data parts from a
workbook and ignores any additional graphics or pivot tables. Both
functions create workbook objects that can only be used to read data,
and we do not recommend end users to use them. Especially not if they
intend to re-export the workbook afterwards.</p>
<p>Once a workbook is imported, we provide several functions to interact
with and modify it (the <code>wb_to_df()</code> function mentioned above
works the same way for an imported workbook). It is possible to add new
sheets and remove sheets, as well as to add or remove data. R-plots can
be inserted and also the style of the workbook can be changed, new
fonts, background colors and number formats. There is a wealth of
options explained in the man pages and the additional style vignette
(more vignettes to follow).</p>
</div>
</div>
<div id="exporting-data" class="section level2">
<h2>Exporting data</h2>
<div id="exporting-data-frames-or-vectors" class="section level3">
<h3>Exporting data frames or vectors</h3>
<p>If you want to export a data frame from R, you can use
<code>write_xlsx()</code> which will create an xlsx file. This file can
be tweaked further. See <code>?write_xlsx</code> to see all the options.
(further explanation and examples will follow).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="at">x =</span> mtcars, <span class="at">file =</span> <span class="st">&quot;mtcars.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="exporting-a-wbworkbook" class="section level3">
<h3>Exporting a <code>wbWorkbook</code></h3>
<p>Imported workbooks can be saved as xlsx or xlsm files with the
wrapper <code>wb_save()</code> or with <code>wb$save()</code>. Both
functions take the filename and an optional <code>overwrite</code>
option. If the latter is set, an optional guard is provided to check if
the file you want to write already exists. But be careful, this is
optional. The default is to save the file and replace an existing file.
Of course, on Windows, files that are locked (for example, if they were
opened by another process) will not be replaced.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># replace the existing file</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>wb<span class="sc">$</span><span class="fu">save</span>(<span class="st">&quot;mtcars.xlsx&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># do not overwrite the existing file</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">try</span>(wb<span class="sc">$</span><span class="fu">save</span>(<span class="st">&quot;mtcars.xlsx&quot;</span>, <span class="at">overwrite =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
</div>
</div>
<div id="dims-wb_dims" class="section level2">
<h2><code>dims</code>/ <code>wb_dims()</code></h2>
<p>In <code>openxlsx2</code> functions that interact with worksheet
cells are using <code>dims</code> as argument and require the users to
provide these. <code>dims</code> are cells or cell ranges in A1
notation. The single argument <code>dims</code> hereby replaces
<code>col</code>/<code>row</code>, <code>cols</code>/<code>rows</code>
and <code>xy</code>. Since A1 notation is rather simple in the first few
columns it might get confusing after the 26. Therefore we provide a
wrapper to construct it:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># various options</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">from_row =</span> <span class="dv">4</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A4&quot;</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span>, <span class="at">cols =</span> <span class="dv">4</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;D4&quot;</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span>, <span class="at">cols =</span> <span class="st">&quot;D&quot;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;D4&quot;</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">cols =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;E4:I10&quot;</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">cols =</span> <span class="st">&quot;A:D&quot;</span>) <span class="co"># same as below</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A4:D10&quot;</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="fu">seq_len</span>(<span class="dv">7</span>), <span class="at">cols =</span> <span class="fu">seq_len</span>(<span class="dv">4</span>), <span class="at">from_row =</span> <span class="dv">4</span>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A4:D10&quot;</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co"># 10 rows and 15 columns from indice B2.</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">from_col =</span> <span class="st">&quot;B&quot;</span>, <span class="at">from_row =</span> <span class="dv">2</span>)</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; [1] &quot;B2:P11&quot;</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co"># data + col names</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars)</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A1:K33&quot;</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co"># only data</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">select =</span> <span class="st">&quot;data&quot;</span>)</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A2:K33&quot;</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co"># The dims of the values of a column in `x`</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">cols =</span> <span class="st">&quot;cyl&quot;</span>)</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; [1] &quot;B2:B33&quot;</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co"># a column in `x` with the column name</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">cols =</span> <span class="st">&quot;cyl&quot;</span>, <span class="at">select =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; [1] &quot;B1:B33&quot;</span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="co"># rows in `x`</span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars)</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A1:K33&quot;</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="co"># in a wb chain</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>()<span class="sc">$</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a>  <span class="fu">add_worksheet</span>()<span class="sc">$</span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a>  <span class="fu">add_data</span>(<span class="at">x =</span> mtcars)<span class="sc">$</span></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="co"># only 1st 5 rows of x data</span></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a>  )<span class="sc">$</span></span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">select =</span> <span class="st">&quot;col_names&quot;</span>), <span class="co"># only column names</span></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;cyan2&quot;</span>)</span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a>  )</span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a></span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a><span class="co"># or if the data&#39;s first coord needs to be located in B2.</span></span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a>wb_dims_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a>  <span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">from_col =</span> <span class="st">&quot;B&quot;</span>, <span class="at">from_row =</span> <span class="dv">2</span>, ...)</span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a>}</span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>()<span class="sc">$</span></span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a>  <span class="fu">add_worksheet</span>()<span class="sc">$</span></span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a>  <span class="fu">add_data</span>(<span class="at">x =</span> mtcars, <span class="at">dims =</span> <span class="fu">wb_dims_custom</span>())<span class="sc">$</span></span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims_custom</span>(<span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb20-62"><a href="#cb20-62" tabindex="-1"></a>  )<span class="sc">$</span></span>
<span id="cb20-63"><a href="#cb20-63" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb20-64"><a href="#cb20-64" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims_custom</span>(<span class="at">select =</span> <span class="st">&quot;col_names&quot;</span>),</span>
<span id="cb20-65"><a href="#cb20-65" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;cyan2&quot;</span>)</span>
<span id="cb20-66"><a href="#cb20-66" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="a-note-on-speed-and-memory-usage" class="section level2">
<h2>A note on speed and memory usage</h2>
<p>The current state of <code>openxlsx2</code> is that it is reasonably
fast. That is, it works well with reasonably large input data when
reading or writing. It may not work well with data that tests the limits
of the <code>openxml</code> specification. Things may slow down on the R
side of things, and performance and usability will depend on the speed
and size of the local operating system’s CPU and memory.</p>
<p>Note that there are at least two cases where <code>openxlsx2</code>
constructs potentially large data frames (i) when loading,
<code>openxlsx2</code> usually needs to read the entire input file into
pugixml and convert it into long data frame(s), and
<code>wb_to_df()</code> converts one long data frame into two data
frames that construct the output object and (ii) when adding data to the
workbook, <code>openxlsx2</code> reshapes the input data frame into a
long data frame and stores it in the workbook, and writes the entire
worksheet into a pugixml file that is written when it is complete.
Applying cell styles, date conversions etc. will further slow down the
process and finally the sheets will be zipped to provide the xlsx
output.</p>
<p>Therefore, if you are faced with an unreasonably large dataset,
either give yourself enough time, use another package to write the xlsx
output (<code>openxlsx2</code> was not written with the intention of
working with maximum memory efficiency), and by all means use other ways
to store data (binary file formats or a database). However, we are
always happy to improve, so if you have found a way to improve what we
are currently doing, please let us know and open an issue or a pull
request.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
