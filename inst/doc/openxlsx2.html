<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>openxlsx2 basic manual</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">openxlsx2 basic manual</h1>



<p>Welcome to the basic manual to <code>openxlsx2</code>. In this manual
you will learn how to use <code>openxlsx2</code> to import data from
xlsx-files to R as well as how to export data from R to xlsx, and how to
import and modify these openxml workbooks in R. This package is based on
the work of many contributors to <code>openxlsx</code>. It was mostly
rewritten using <code>pugixml</code> and <code>R6</code> making use of
modern technology, providing a fresh and easy to use R package.</p>
<p>Over the years many people have worked on the tricky task to handle
xls and xlsx files. Notably <code>openxlsx</code>, but there are
countless other R-packages as well as third party libraries or
calculation software capable of handling such files. Please feel free to
use and test your files with other software and or let us know about
your experience. Open an issue on github or write us a mail.</p>
<div id="first-steps" class="section level3">
<h3>First steps</h3>
<p>First letâ€™s assume that you have a working installation of
<code>openxlsx2</code> otherwise run the lines below to install the
latest CRAN release:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;openxlsx2&quot;</span>)</span></code></pre></div>
<p>Now we load the library:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(openxlsx2)</span></code></pre></div>
</div>
<div id="handling-workbooks" class="section level3">
<h3>Handling workbooks</h3>
<p>The foundation of <code>openxlsx2</code> is a workbook object. You
can think of this object as a workbook loaded in a spreadsheet software.
We import the entire thing. Every sheet, every chart, image, column,
formula style, conditional formatting, pivot table and whatever else a
spreadsheet file is allowed to carry. Therefore if you have a file that
you want to work with, you can load it with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_load</span>(<span class="st">&quot;your_file.xlsx&quot;</span>)</span></code></pre></div>
<p>We usually name workbook objects <code>wb</code> in our
documentation, but this is no obligation, you can name your workbook
object whatever you like to call them.</p>
<p>If you do not have a workbook yet, it is possible to create one. In
the next line we will use three wrapper functions
<code>wb_workbook()</code>, <code>wb_add_worksheet()</code>, and
<code>wb_add_data()</code>. The wrapper functions are piped together
using the classic <code>magrittr</code> pipe operator
<code>%&gt;%</code>, but similarly you can use the <code>R</code>â€™s
native pipe operator <code>|&gt;</code>. <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> We assume that you
have a dataset <code>your_data</code>, either a vector, a matrix or a
data frame and want to write this in a worksheet:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>() <span class="sc">%&gt;%</span> <span class="fu">wb_add_worksheet</span>() <span class="sc">%&gt;%</span> <span class="fu">wb_add_data</span>(<span class="at">x =</span> your_data)</span></code></pre></div>
<p>Okay, now you have a workbook object, but what have we actually done?
Letâ€™s work along the pipe syntax: (1) first we have created the workbook
object <code>wb_worbkook()</code>, (2) next we have assigned it a
worksheet <code>wb_add_worksheet()</code>, and (3) we have written data
onto the worksheet.</p>
<p>Letâ€™s try this with actual data. We use the <code>mtcars</code>
dataset. In the code we switch the fictional <code>your_data</code> with
<code>mtcars</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>() <span class="sc">%&gt;%</span> <span class="fu">wb_add_worksheet</span>() <span class="sc">%&gt;%</span> <span class="fu">wb_add_data</span>(<span class="at">x =</span> mtcars)</span></code></pre></div>
<p>Letâ€™s see what the output looks like:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>wb</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; A Workbook object.</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Worksheets:</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;  Sheets: Sheet 1 </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;  Write order: 1</span></span></code></pre></div>
<p>The output looks a little cryptic, it simply tells the name of the
worksheet: <code>wb_add_worksheet()</code> created a default worksheet
name <code>&quot;Sheet 1&quot;</code>. In the code above you can see that we do
not use <code>sheet</code> to tell <code>wb_add_data()</code> where it
should write the data. This is because internally we use a waiver
<code>current_sheet()</code> so that we do not have to write
<code>sheet = &quot;Sheet 1&quot;</code> whenever we work on the same worksheet.
Basically the current sheet is updated whenever a new worksheet is added
to the workbook.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>() <span class="sc">%&gt;%</span> <span class="fu">wb_add_worksheet</span>() <span class="sc">%&gt;%</span> <span class="fu">wb_add_worksheet</span>() <span class="sc">%&gt;%</span> <span class="fu">wb_add_data</span>(<span class="at">x =</span> mtcars)</span></code></pre></div>
<p>This will create two sheets <code>&quot;Sheet 1&quot;</code> and
<code>&quot;Sheet 2&quot;</code> and the data will be written to the second
sheet.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>wb</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; A Workbook object.</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; Worksheets:</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;  Sheets: Sheet 1, Sheet 2 </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;  Write order: 1, 2</span></span></code></pre></div>
<p>So how can we access the data on the sheet? Either with
<code>wb_to_df()</code> our internal handler to read from workbooks
(this is the underlying function for <code>wb_read()</code> and
<code>read_xlsx()</code> which are mere aliases for
<code>wb_to_df()</code>). So lets have a look at the top of the
output:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>wb <span class="sc">%&gt;%</span> <span class="fu">wb_to_df</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; sheet found, but contains no data</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Ah! The output is on the second sheet. We need either
<code>sheet = 2</code> or <code>sheet = &quot;Sheet 2&quot;</code>. We go with the
second variant, because the sheet index position and their name might
differ.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>wb <span class="sc">%&gt;%</span> <span class="fu">wb_to_df</span>(<span class="at">sheet =</span> <span class="st">&quot;Sheet 2&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt;    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; 2 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; 3 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; 4 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; 5 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; 6 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 7 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span></code></pre></div>
<p>This looks like the head of the <code>mtcars</code> dataset. So we
have successfully read from the workbook. Now you want to export the
workbook to a file:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>wb <span class="sc">%&gt;%</span> <span class="fu">wb_save</span>(<span class="at">file =</span> <span class="st">&quot;my_first_worksheet.xlsx&quot;</span>)</span></code></pre></div>
<p>Alternatively you can directly open it in a spreadsheet software (if
you have one installed):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>wb <span class="sc">%&gt;%</span> <span class="fu">wb_open</span>()</span></code></pre></div>
<p>Once again, lets try this with the <code>USPersonalExpenditure</code>
dataset:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>()</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">wb_add_worksheet</span>(wb, <span class="at">sheet =</span> <span class="st">&quot;USexp&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">wb_add_data</span>(wb, <span class="st">&quot;USexp&quot;</span>, USPersonalExpenditure)</span></code></pre></div>
<pre><code>#&gt; Error : Can&#39;t add data to a workbook with no worksheet.
#&gt; Did you forget to add a worksheet with `wb_add_worksheet()`?</code></pre>
<p>Dang! What did we do? Weâ€™ve added a worksheet, but wait, did we? No,
you have to assign wrapper functions to an object for them to have an
effect. Wrapper functions do not alter the workbook objects they are
executed on. You can check that the workbook has no worksheets:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>wb <span class="sc">%&gt;%</span> <span class="fu">wb_get_sheet_names</span>()</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; named character(0)</span></span></code></pre></div>
<p>Once we assign a sheet, this changes, and the data was correctly
written:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>()</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_add_worksheet</span>(wb, <span class="at">sheet =</span> <span class="st">&quot;USexp&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_add_data</span>(wb, <span class="st">&quot;USexp&quot;</span>, USPersonalExpenditure)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="fu">wb_get_sheet_names</span>(wb)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt;   USexp </span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; &quot;USexp&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">wb_to_df</span>(wb)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt;     1940   1945  1950 1955  1960</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; 2 22.200 44.500 59.60 73.2 86.80</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; 3 10.500 15.500 29.00 36.5 46.20</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; 4  3.530  5.760  9.71 14.0 21.10</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; 5  1.040  1.980  2.45  3.4  5.40</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; 6  0.341  0.974  1.80  2.6  3.64</span></span></code></pre></div>
<p>Now youâ€™re probably thinking, I donâ€™t want to assign the workbook
object all the time and all the <code>wb_</code> functions are a little
tedious to type. There is an alternative for you and it is called
chaining. Since the workbook is a <code>R6</code> object internally, you
can make use of chains. Basically every function that starts with
<code>wb_</code> should have a underlying function of the same name
without the prefix. So our data writing example from above can be
written as:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>()<span class="sc">$</span><span class="fu">add_worksheet</span>(<span class="st">&quot;USexp&quot;</span>)<span class="sc">$</span><span class="fu">add_data</span>(<span class="at">x =</span> USPersonalExpenditure)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>wb<span class="sc">$</span><span class="fu">to_df</span>()</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt;     1940   1945  1950 1955  1960</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; 2 22.200 44.500 59.60 73.2 86.80</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; 3 10.500 15.500 29.00 36.5 46.20</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; 4  3.530  5.760  9.71 14.0 21.10</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt; 5  1.040  1.980  2.45  3.4  5.40</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; 6  0.341  0.974  1.80  2.6  3.64</span></span></code></pre></div>
<p>Whether you use wrapper functions or chain functions is up to you and
personal preference. There is just one thing to remember, the
documentation is exclusively written for the wrapper function. So if you
want to know the arguments for the <code>wb$add_data()</code> part, you
have to lookup the wrapper functions man page
<code>?wb_add_data</code>.</p>
</div>
<div id="importing-as-workbook" class="section level3">
<h3>Importing as workbook</h3>
<p>In addition to importing directly from xlsx or xlsm files,
<code>openxlsx2</code> provides the <code>wbWorkbook</code> class used
for importing and modifying entire the openxml files in <code>R</code>.
This <code>workbook</code> class is the heart of <code>openxlsx2</code>
and probably the reason why you are reading this manual in the first
place.</p>
<p>Importing a file into a workbook looks like this:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># the file we are going to load</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;openxlsx2_example.xlsx&quot;</span>, <span class="at">package =</span> <span class="st">&quot;openxlsx2&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># loading the file into the workbook</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_load</span>(<span class="at">file =</span> file)</span></code></pre></div>
<p>The additional options <code>wb_load()</code> provides are for
internal use: <code>sheet</code> loads only a selected sheet from the
workbook and <code>data_only</code> reads only the data parts from a
workbook and ignores any additional graphics or pivot tables. Both
functions create workbook objects that can only be used to read data,
and we do not recommend end users to use them. Especially not if they
intend to re-export the workbook afterwards.</p>
<p>Once a workbook is imported, we provide several functions to interact
with and modify it (the <code>wb_to_df()</code> function mentioned above
works the same way for an imported workbook). It is possible to add new
sheets and remove sheets, as well as to add or remove data. R-plots can
be inserted and also the style of the workbook can be changed, new
fonts, background colors and number formats. There is a wealth of
options explained in the man pages and the additional style vignette
(more vignettes to follow).</p>
</div>
<div id="exporting-data" class="section level2">
<h2>Exporting data</h2>
<div id="exporting-data-frames-or-vectors" class="section level3">
<h3>Exporting data frames or vectors</h3>
<p>If you want to export a data frame from R, you can use
<code>write_xlsx()</code> which will create an xlsx file. This file can
be tweaked further. See <code>?write_xlsx</code> to see all the options.
(further explanation and examples will follow).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="at">x =</span> mtcars, <span class="at">file =</span> <span class="st">&quot;mtcars.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="exporting-a-wbworkbook" class="section level3">
<h3>Exporting a <code>wbWorkbook</code></h3>
<p>Imported workbooks can be saved as xlsx or xlsm files with the
wrapper <code>wb_save()</code> or with <code>wb$save()</code>. Both
functions take the filename and an optional <code>overwrite</code>
option. If the latter is set, an optional guard is provided to check if
the file you want to write already exists. But be careful, this is
optional. The default is to save the file and replace an existing file.
Of course, on Windows, files that are locked (for example, if they were
opened by another process) will not be replaced.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># replace the existing file</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>wb<span class="sc">$</span><span class="fu">save</span>(<span class="st">&quot;mtcars.xlsx&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># do not overwrite the existing file</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">try</span>(wb<span class="sc">$</span><span class="fu">save</span>(<span class="st">&quot;mtcars.xlsx&quot;</span>, <span class="at">overwrite =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
</div>
</div>
<div id="dims-wb_dims" class="section level2">
<h2><code>dims</code>/ <code>wb_dims()</code></h2>
<p>In <code>openxlsx2</code> functions that interact with worksheet
cells are using <code>dims</code> as argument and require the users to
provide these. <code>dims</code> are cells or cell ranges in A1
notation. The single argument <code>dims</code> hereby replaces
<code>col</code>/<code>row</code>, <code>cols</code>/<code>rows</code>
and <code>xy</code>. Since A1 notation is rather simple in the first few
columns it might get confusing after the 26. Therefore we provide a
wrapper to construct it:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># various options</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">from_row =</span> <span class="dv">4</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A4&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span>, <span class="at">cols =</span> <span class="dv">4</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;D4&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span>, <span class="at">cols =</span> <span class="st">&quot;D&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;D4&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">cols =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;E4:I10&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">cols =</span> <span class="st">&quot;A:D&quot;</span>) <span class="co"># same as below</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A4:D10&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="fu">seq_len</span>(<span class="dv">7</span>), <span class="at">cols =</span> <span class="fu">seq_len</span>(<span class="dv">4</span>), <span class="at">from_row =</span> <span class="dv">4</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A4:D10&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># 10 rows and 15 columns from indice B2.</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">from_col =</span> <span class="st">&quot;B&quot;</span>, <span class="at">from_row =</span> <span class="dv">2</span>)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;B2:P11&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co"># data + col names</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A1:K33&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># only data</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">select =</span> <span class="st">&quot;data&quot;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A2:K33&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co"># The dims of the values of a column in `x`</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">cols =</span> <span class="st">&quot;cyl&quot;</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;B2:B33&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># a column in `x` with the column name</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">cols =</span> <span class="st">&quot;cyl&quot;</span>, <span class="at">select =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;B1:B33&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># rows in `x`</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;A1:K33&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="co"># in a wb chain</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>()<span class="sc">$</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="fu">add_worksheet</span>()<span class="sc">$</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="fu">add_data</span>(<span class="at">x =</span> mtcars)<span class="sc">$</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="co"># only 1st 5 rows of x data</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  )<span class="sc">$</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">select =</span> <span class="st">&quot;col_names&quot;</span>), <span class="co"># only column names</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;cyan2&quot;</span>)</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>  )</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="co"># or if the data&#39;s first coord needs to be located in B2.</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>wb_dims_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>  <span class="fu">wb_dims</span>(<span class="at">x =</span> mtcars, <span class="at">from_col =</span> <span class="st">&quot;B&quot;</span>, <span class="at">from_row =</span> <span class="dv">2</span>, ...)</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>}</span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_workbook</span>()<span class="sc">$</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>  <span class="fu">add_worksheet</span>()<span class="sc">$</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>  <span class="fu">add_data</span>(<span class="at">x =</span> mtcars, <span class="at">dims =</span> <span class="fu">wb_dims_custom</span>())<span class="sc">$</span></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims_custom</span>(<span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>  )<span class="sc">$</span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a>  <span class="fu">add_fill</span>(</span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>    <span class="at">dims =</span> <span class="fu">wb_dims_custom</span>(<span class="at">select =</span> <span class="st">&quot;col_names&quot;</span>),</span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">wb_color</span>(<span class="st">&quot;cyan2&quot;</span>)</span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="a-note-on-speed-and-memory-usage" class="section level2">
<h2>A note on speed and memory usage</h2>
<p>The current state of <code>openxlsx2</code> is that it is reasonably
fast. That is, it works well with reasonably large input data when
reading or writing. It may not work well with data that tests the limits
of the <code>openxml</code> specification. Things may slow down on the R
side of things, and performance and usability will depend on the speed
and size of the local operating systemâ€™s CPU and memory.</p>
<p>Note that there are at least two cases where <code>openxlsx2</code>
constructs potentially large data frames (i) when loading,
<code>openxlsx2</code> usually needs to read the entire input file into
pugixml and convert it into long data frame(s), and
<code>wb_to_df()</code> converts one long data frame into two data
frames that construct the output object and (ii) when adding data to the
workbook, <code>openxlsx2</code> reshapes the input data frame into a
long data frame and stores it in the workbook, and writes the entire
worksheet into a pugixml file that is written when it is complete.
Applying cell styles, date conversions etc. will further slow down the
process and finally the sheets will be zipped to provide the xlsx
output.</p>
<p>Therefore, if you are faced with an unreasonably large dataset,
either give yourself enough time, use another package to write the xlsx
output (<code>openxlsx2</code> was not written with the intention of
working with maximum memory efficiency), and by all means use other ways
to store data (binary file formats or a database). However, we are
always happy to improve, so if you have found a way to improve what we
are currently doing, please let us know and open an issue or a pull
request.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Basically a pipe operator allows to write code from left
to right. Without pipes the code would look like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">wb_add_data</span>(<span class="fu">wb_add_worksheet</span>(<span class="fu">wb_workbook</span>()), <span class="at">x =</span> your_data)</span></code></pre></div>
<a href="#fnref1" class="footnote-back">â†©ï¸Ž</a></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
